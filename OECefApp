#ifndef OSGEARTH_CEF_OECEFAPP
#define OSGEARTH_CEF_OECEFAPP 1

#include "include/cef_app.h"

#include "RenderProcessHandler"

namespace osgEarth { namespace Cef
{

class OECefApp : public CefApp
{
public:
  OECefApp() { _renderProcHandler = new RenderProcessHandler(); }

public:
  CefRefPtr<CefRenderProcessHandler> GetRenderProcessHandler() { return _renderProcHandler; }

  virtual void OnBeforeCommandLineProcessing(
     const CefString& process_type,
     CefRefPtr<CefCommandLine> command_line)
  {
      command_line->AppendSwitch( "disable-gpu" );
      command_line->AppendSwitch( "disable-gpu-compositing" );
      command_line->AppendSwitch( "disable-webgl" );
      command_line->AppendSwitch( "disable-3d-apis" );
      command_line->AppendSwitch( "enable-begin-frame-scheduling" ); 
  }

private:
  CefRefPtr<CefRenderProcessHandler> _renderProcHandler;

  IMPLEMENT_REFCOUNTING(OECefApp);
};

} }

#endif
